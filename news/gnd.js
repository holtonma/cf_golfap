var portal;function processFeeds(B,A){feed_html="";B.each(function(D){if(D.CATEGORY==A){var C=D.DESCRIP.unescapeHTML().strip();var E=new Template("<div class='article_title'><a href='#{LINK}' target='_blank'>#{TITLE}</a></div><div>"+C+"</div>");feed_html+=E.evaluate(D)}});return feed_html}function onOverWidget(A,B){B.getElement().insertBefore($("control_buttons"),B.getElement().firstChild);$("control_buttons").show()}function onOutWidget(A,B){$("control_buttons").hide()}function removeWidget(A){var B=$(A).up(".widget").widget;if(confirm("Are sure to remove this widget?")){document.body.appendChild($("control_buttons").hide());portal.remove(B)}}function onChange(){}function init(){$("failure").setStyle({borderColor:"#006600"});$("failure").show();$("failure").innerHTML="loading all news stories...";var A="getNews.cfm";var B="";new Ajax.Request(A,{method:"Post",asynchronous:true,parameters:B,onFailure:function(){$("failure").show();$("failure").setStyle({borderColor:"#EE0000"});$("failure").innerHTML="Please click your browser's refresh button again, the stories did not load.";init()},onComplete:function(F){var C=F.responseText.evalJSON(true);var E=C;portal=new Xilinus.Portal("#page div",{onOverWidget:onOverWidget,onOutWidget:onOutWidget,onChange:onChange,removeEffect:Effect.SwitchOff});var D=1;portal.add(new Xilinus.Widget().setTitle("Tour News").setContent(processFeeds(E,D)),0);var D=3;portal.add(new Xilinus.Widget().setTitle("Courses and Travel").setContent(processFeeds(E,D)),2);var D=6;portal.add(new Xilinus.Widget().setTitle("The Masters").setContent(processFeeds(E,D)),1);var D=5;portal.add(new Xilinus.Widget().setTitle("USGA").setContent(processFeeds(E,D)),1);var D=4;portal.add(new Xilinus.Widget().setTitle("Instruction").setContent(processFeeds(E,D)),1);var D=2;portal.add(new Xilinus.Widget().setTitle("Equipment").setContent(processFeeds(E,D)),2);portal.addWidgetControls("control_buttons")},onSuccess:function(){$("failure").hide();$("failure").innerHTML=""}})}Event.observe(window,"load",init)